---
import { type TProductCategory } from "@rxdrag/website-lib-core";
import { ProductCategoryQueryOptions, ProductCategoryFields } from "@rxdrag/rxcms-models";
import { rx } from "theme";
import { Popover, Link, Motion, PopoverPanel } from "@rxdrag/website-lib";
interface Props {
  title?: string;
  categories?: TProductCategory[];
}
const { title = "Продукты", categories } = Astro.props;---

<Popover class="flex items-center h-full" openableKey="products-popup">
  <div class="flex items-center">
    <Link
      class:list={[
        "desk-nav-link",
        "flex items-center gap-x-1 h-full",
      ]}
      activeWhen="/products"
      type="products"
    >
      {title}
    </Link>
    <Motion
      as="span"
      class="h-5 w-5 flex-none text-white scrolled:text-black group-hover/header:text-black"
      id="products-arrow"
      whileOpenable={{ open: { rotate: 180 }, close: { rotate: 0 } }}
    >
      <svg
        aria-hidden="true"
        fill="currentColor"
        focusable="false"
        height="1.25rem"
        viewBox="0 0 24 24"
        width="1.25rem"
      >
        <path d="M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"></path>
      </svg>
    </Motion>
  </div>
  <PopoverPanel
    class:list={[
      "bg-surface-card shadow-lg light rounded-md",
      "absolute top-full min-w-full left-0 w-[400px]",
      "opacity-1 overflow-hidden z-20",
    ]}
    animate={{
      initial: {
        height: 0,
      },
    }}
    whileOpenable={{
      initial: {
        height: 0,
      },
      open: {
        to: {
          height: "auto",
        },
        duration: 0.6,
        ease: "power3.out",
      },
      close: {
        to: {
          height: 0,
        },
        duration: 0.25,
        ease: "power2.in",
      },
    }}
  >
    <div class="w-full h-full flex flex-col text-lg font-mono uppercase">
      {
        categories?.map((category) => (
          <Link
            class="!text-black hover:text-primary hover:scale-105 p-6 py-2 actived:bg-primary-500 actived:text-[#F0F1EC] transition-all duration-300"
            type="product-category"
            to={category?.slug}
          >
            {category.name}
          </Link>
        ))
      }
    </div>
  </PopoverPanel></Popover
>